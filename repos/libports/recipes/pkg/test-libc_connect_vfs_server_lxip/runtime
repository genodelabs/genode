runtime | ram: 128M | caps: 1100 | binary: init

+ requires | + timer

+ fail    | after_seconds: 15
+ fail    | : *exited with exit value -1
+ succeed | : child "test-libc_connect" exited with exit value 0

+ content
  + rom | label: black_hole
  + rom | label: ld.lib.so
  + rom | label: libc.lib.so
  + rom | label: libm.lib.so
  + rom | label: posix.lib.so
  + rom | label: vfs.lib.so
  + rom | label: vfs_lxip.lib.so
  + rom | label: lxip.lib.so
  + rom | label: nic_router
  + rom | label: vfs
  + rom | label: test-netty_tcp
  + rom | label: test-libc_connect

+ config | verbose: yes
  + parent-provides
    + service ROM
    + service IRQ
    + service IO_MEM
    + service IO_PORT
    + service PD
    + service RM
    + service CPU
    + service LOG
    + service Timer

  + default-route
    + any-service
      + parent
      + any-child

  + default | caps: 150

  + start nic_router | ram: 10M
    + provides
      + service Nic
      + service Uplink
    + config
      + domain uplink  | interface: 10.0.2.1/24
      + domain default | interface: 10.0.1.1/24
        + ip | dst: 10.0.2.0/24 | domain: uplink
      + policy | label_prefix: black_hole | domain: uplink
      + default-policy                    | domain: default

  + start black_hole | ram: 2M
    + config | + uplink_client

  + start socket_fs_server | caps: 200 | ram: 10M
    + binary vfs
    + provides | + service File_system
    + config
      + vfs
        + lxip | ip_addr: 10.0.1.2 | netmask: 255.255.255.0 | gateway: 10.0.1.1
      + policy | label_prefix: server | root: / | writeable: yes

  + start socket_fs_client | caps: 200 | ram: 10M
    + binary vfs
    + provides | + service File_system
    + config
      + vfs
        + lxip | ip_addr: 10.0.1.3 | netmask: 255.255.255.0 | gateway: 10.0.1.1
      + policy | label_prefix: test-libc_connect | root: / | writeable: yes

  + start server | ram: 4M
    + binary test-netty_tcp
    + config | port: 80 | read_write: yes | nonblock: false
    | + vfs
    |   + dir dev    | + log
    |   + dir socket | + fs
    |   + dir tmp    | + ram
    | + libc | stdout: /dev/log | stderr: /dev/log | socket: /socket
    + route
      + service File_system | + child socket_fs_server
      + any-service
        + parent
        + any-child

  + start test-libc_connect | ram: 4M
    + config
    | + vfs
    |   + dir dev    | + log
    |   + dir socket | + fs
    | + libc | stdout: /dev/log | stderr: /dev/log | socket: /socket
    |          connect_timeout_sec: 1
    + route
      + service File_system | + child socket_fs_client
      + any-service
        + parent
        + any-child
-
