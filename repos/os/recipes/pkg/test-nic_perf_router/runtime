runtime | ram: 40M | caps: 2000 | binary: init

+ requires | + timer

+ fail    | after_seconds: 60
+ succeed | : child "nic_perf_tx" exited with exit value 0

+ content
  + rom | label: ld.lib.so
  + rom | label: nic_router
  + rom | label: nic_perf

+ config
  + parent-provides
    + service ROM
    + service PD
    + service RM
    + service CPU
    + service LOG
    + service Timer

  + default-route
    + any-service
      + parent
      + any-child

  + default | caps: 500

  + start nic_perf_tx | ram: 10M
    + binary nic_perf
    + provides
      + service Uplink
      + service Nic
    + config | period_ms: 5000 | count: 8
      + nic-client
        + tx | mtu: 1500 | to: 10.0.1.1 | udp_port: 12345
    + route
      + service Nic | + child nic_router
      + any-service
        + any-child
        + parent

  + start nic_router | ram: 10M
    + provides
      + service Nic
      + service Uplink
    + config | verbose_packet_drop: yes
      + policy | label_suffix: nic_perf_tx ->  | domain: sender
      + policy | label_suffix: nic_perf_rx ->  | domain: receiver
      + domain sender | interface: 10.0.1.1/24
      | + dhcp-server | ip_first: 10.0.1.2 | ip_last:  10.0.1.2
      | + nat | domain: receiver | tcp-ports: 100 | udp-ports: 100 | icmp-ids:  100
      | + udp-forward | port: 12345 | to: 10.0.2.2 | domain: receiver
      | x ip | dst: 0.0.0.0/0 | domain: receiver
      + domain receiver | interface: 10.0.2.1/24
        + dhcp-server | ip_first: 10.0.2.2 | ip_last:  10.0.2.2

  + start nic_perf_rx | ram: 10M
    + binary nic_perf
    + provides
      + service Uplink
      + service Nic
    + config | period_ms: 5000
      + nic-client
    + route
      + service Nic | + child nic_router
      + any-service
        + any-child
        + parent

-
